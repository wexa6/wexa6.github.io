---
title: "07CTF – pd_what Challenge"
date: 2025-09-14
categories: [CTFs, 07CTF]
tags: [forensics]
hidden: true
---
## Challenge Details
-   Name: pd_what
-   Category: Forensics

**The challenge provides two files:**
-   `chal.pdf`: A pdf which has Linux running inside it.
* * * * *
## Challenge description
<p style="font-size:14px;">
Here is a fun little PDF I found! I added a flag into it, nothing special, just a good old zip file. But, will you be able to read it in this very limited environment? Open it with a Chromium-based browser like Chrome if you want it to work! I am not the author of the original project.
</p>
* * * * *
## Solution

This was interesting challenge that revolved around a very unique concept: a PDF file that runs a full RISCV32 Linux emulator in-browser, 
based on the [LinuxPDF project on GitHub](https://github.com/ading2210/linuxpdf) 

> Note that you must open this pdf with a `Chromium-based browser` to be able to work with it.

![](/assets/img/07ctf/pd1.png){:width="550px"}

Well back to the challenge, the first command i used here was `ls` to get a lay of the land.

![](/assets/img/07ctf/pd2.png){:width="550px"}

The output showed a single file: `flag.zip` This was our target, *but we are in a very limited environment*, which means that most of tools present here would be either missing or old.

Here it comes to my mind the idea of transfering this file to another envoirment where I can use other commands or bruteforcing this protected file 

## Exfiltration Plan
My main goal was to transfer the `flag.zip` file, bit for bit, from the emulator to my own machine where I could use proper tools.

### Method 1 (base64)
> Some people prefer to use the `base64` method where you:
-   Encode the whole zip file using `base64`
-   Copy every byte from the output
-   Decode the encoded text on another machine
-   And there you go, you have the zipped file

![](/assets/img/07ctf/pd3.png){:width="550px"}

*But i found this one very diffcult for my little eyes to see :)*

### Method 2 (hexdump)
So i used the `hexdump` method, where I use `hexdump -C flag.zip` command and then copy every single hexadecimal number extracted from the output *(still hard to see tbh)*

![](/assets/img/07ctf/pd4.png){:width="550px"}

Now, with the raw hex data copied, I needed to reassemble the file. For this, I used `HxD`, a hex editor. I pasted the hex values directly into the editor, which interpreted them and reconstructed the original `flag.zip` file byte by byte.

```
50 4B 03 04 0A 00 09 00 00 00 D4 8B 4E 5A 10 16 
15 FA 33 00 00 00 27 00 00 00 08 00 1C 00 66 6C 
61 67 2E 74 78 74 55 54 09 00 03 0F C4 AF 67 0F 
C4 AF 67 75 78 0B 00 01 04 E8 03 00 00 04 E8 03 
00 00 2B 4E 5A 7B 75 5A A1 8A 61 43 5B E2 CE E8 
17 94 60 98 5A E9 28 07 2C 90 8F CE 9B 7E C0 C5 
B1 9E 09 8F D5 BF C2 85 15 C8 C7 0D 9F 39 AD D2 
0D 70 93 62 D6 50 4B 07 08 10 16 15 FA 33 00 00 
00 27 00 00 00 50 4B 01 02 1E 03 0A 00 09 00 00 
00 D4 8B 4E 5A 10 16 15 FA 33 00 00 00 27 00 00 
00 08 00 18 00 00 00 00 00 01 00 00 00 A4 81 00 
00 00 00 66 6C 61 67 2E 74 78 74 55 54 05 00 03 
0F C4 AF 67 75 78 0B 00 01 04 E8 03 00 00 04 E8 
03 00 00 50 4B 05 06 00 00 00 00 01 00 01 00 4E 
00 00 00 85 00 00 00 00 00 00 00 00 00 00 00 00
```

![](/assets/img/07ctf/pd5.png){:width="550px"}

I tried to open the newly saved `flag.zip`, and as expected, it was protected with a password. *This is where standard password cracking tools come into play*.

### Bruteforcing the file

I ran the following command to extract the hash and save it to a file named `zip.hash`:
```
zip2john flag.zip > zip.hash
```

Now, with the hash isolated, I could use `John` on it. Using a standard wordlist (like `rockyou.txt`), John rapidly hashes each password guess and compares it to the hash from the file.

And within seconds, John worked and the password was cracked: `Braxton78`

![](/assets/img/07ctf/pd6.png)

### Flag

*drgn{l1nux_0n_4_pdf??_1'v3_s33n_1t_4ll}*

[⬅ Back to 07CTF Writeups](/posts/07CTF-writeups/)
